
> chamasmart-backend@1.0.0 test
> jest --runInBand --no-coverage

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: â‰¡Æ’Ã´Ã­ add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

POST /api/auth/register 400 11.933 ms - anonymous - {"email":"test1768823022163@example.com","password":"[REDACTED]","firstName":"Test","lastName":"User","phoneNumber":"1234567890"}
POST /api/auth/register 400 2.000 ms - anonymous - {"email":"test@example.com"}
POST /api/auth/register 400 0.946 ms - anonymous - {"email":"duplicate1768823022340@example.com","password":"[REDACTED]","firstName":"Test","lastName":"User","phoneNumber":"1234567890"}
POST /api/auth/register 400 0.970 ms - anonymous - {"email":"duplicate1768823022340@example.com","password":"[REDACTED]","firstName":"Test","lastName":"User","phoneNumber":"1234567890"}
POST /api/auth/register 400 0.748 ms - anonymous - {"email":"logintest1768823022362@example.com","password":"[REDACTED]","firstName":"Login","lastName":"Test","phoneNumber":"1234567890"}
  console.log
    Querying database for user: nonexistent@example.com

      at log (controllers/authController.js:262:13)

POST /api/auth/login 500 144.004 ms - anonymous - {"email":"nonexistent@example.com","password":"[REDACTED]"}
FAIL tests/auth.test.js
  Authentication API
    POST /api/auth/register
      â”œÃ¹ should register a new user (163 ms)
      Î“ÃªÃœ should reject registration with missing fields (15 ms)
      â”œÃ¹ should reject duplicate email (21 ms)
    POST /api/auth/login
      â”œÃ¹ should login with correct credentials (5 ms)
      â”œÃ¹ should reject login with wrong password (3 ms)
      â”œÃ¹ should reject login with non-existent email (178 ms)
  Health Check API
    Î“ÃªÃœ should return health status (9 ms)

  Î“Ã¹Ã… Authentication API Î“Ã‡â•‘ POST /api/auth/register Î“Ã‡â•‘ should register a new user

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 400

      15 |                 });
      16 |
    > 17 |             expect(res.statusCode).toBe(201);
         |                                    ^
      18 |             expect(res.body).toHaveProperty('success', true);
      19 |             expect(res.body).toHaveProperty('token');
      20 |             expect(res.body.data).toHaveProperty('user_id');

      at Object.toBe (tests/auth.test.js:17:36)

  Î“Ã¹Ã… Authentication API Î“Ã‡â•‘ POST /api/auth/register Î“Ã‡â•‘ should reject duplicate email

    expect(received).toContain(expected) // indexOf

    Expected substring: "already exists"
    Received string:    "Validation error"

      59 |
      60 |             expect(res.statusCode).toBe(400);
    > 61 |             expect(res.body.message).toContain('already exists');
         |                                      ^
      62 |         });
      63 |     });
      64 |

      at Object.toContain (tests/auth.test.js:61:38)

  Î“Ã¹Ã… Authentication API Î“Ã‡â•‘ POST /api/auth/login Î“Ã‡â•‘ should login with correct credentials

    TypeError: Cannot read properties of undefined (reading 'email')

      85 |                 .post('/api/auth/login')
      86 |                 .send({
    > 87 |                     email: testUser.email,
         |                                     ^
      88 |                     password: 'Test123!@#',
      89 |                 });
      90 |

      at Object.email (tests/auth.test.js:87:37)

  Î“Ã¹Ã… Authentication API Î“Ã‡â•‘ POST /api/auth/login Î“Ã‡â•‘ should reject login with wrong password

    TypeError: Cannot read properties of undefined (reading 'email')

       98 |                 .post('/api/auth/login')
       99 |                 .send({
    > 100 |                     email: testUser.email,
          |                                     ^
      101 |                     password: 'WrongPassword',
      102 |                 });
      103 |

      at Object.email (tests/auth.test.js:100:37)

  Î“Ã¹Ã… Authentication API Î“Ã‡â•‘ POST /api/auth/login Î“Ã‡â•‘ should reject login with non-existent email

    expect(received).toBe(expected) // Object.is equality

    Expected: 401
    Received: 500

      114 |                 });
      115 |
    > 116 |             expect(res.statusCode).toBe(401);
          |                                    ^
      117 |         });
      118 |     });
      119 | });

      at Object.toBe (tests/auth.test.js:116:36)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    SERVER FATAL ERROR: listen EADDRINUSE: address already in use :::5005

    [0m [90m 226 |[39m [90m// Start server[39m
     [90m 227 |[39m server[33m.[39mon([32m"error"[39m[33m,[39m (err) [33m=>[39m {
    [31m[1m>[22m[39m[90m 228 |[39m   console[33m.[39merror([32m"SERVER FATAL ERROR:"[39m[33m,[39m err[33m.[39mmessage)[33m;[39m
     [90m     |[39m           [31m[1m^[22m[39m
     [90m 229 |[39m   [36mif[39m (err[33m.[39mcode [33m===[39m [32m"EADDRINUSE"[39m) {
     [90m 230 |[39m     process[33m.[39mexit([35m1[39m)[33m;[39m
     [90m 231 |[39m   }[0m

      at Server.error (server.js:228:11)

  Î“Ã¹Ã…  process.exit called with "1"

      228 |   console.error("SERVER FATAL ERROR:", err.message);
      229 |   if (err.code === "EADDRINUSE") {
    > 230 |     process.exit(1);
          |             ^
      231 |   }
      232 | });
      233 |

      at Server.exit (server.js:230:13)
