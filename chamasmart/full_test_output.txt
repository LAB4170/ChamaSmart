
> chamasmart@1.0.0 test
> npm run test:backend --no-coverage --runInBand

npm warn Unknown cli config "--coverage". This will stop working in the next major version of npm.
npm warn Unknown cli config "--runInBand". This will stop working in the next major version of npm.

> chamasmart@1.0.0 test:backend
> cd backend && npm test

npm warn Unknown env config "runinband". This will stop working in the next major version of npm.

> chamasmart-backend@1.0.0 test
> jest --runInBand

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/proposalController.test.js (10.707 s)
  ProposalController.castVote - membership-checked voting
    Î“ÃªÃœ rejects vote from non-member (15 ms)
    Î“ÃªÃœ allows member to vote once and rejects duplicate votes (3 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent building .env in docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

  console.log
    Querying database for user: test@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: Cannot read properties of undefined (reading 'rows') TypeError: Cannot read properties of undefined (reading 'rows')
        at rows (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:267:62)
        at processTicksAndRejections (node:internal/process/task_queues:103:5)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)

POST /api/auth/login 500 159.424 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: test@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: Cannot read properties of undefined (reading 'rows') TypeError: Cannot read properties of undefined (reading 'rows')
        at rows (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:267:62)
        at processTicksAndRejections (node:internal/process/task_queues:103:5)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)

POST /api/auth/login 500 37.452 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: test@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: Cannot read properties of undefined (reading 'rows') TypeError: Cannot read properties of undefined (reading 'rows')
        at rows (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:267:62)
        at processTicksAndRejections (node:internal/process/task_queues:103:5)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)

POST /api/auth/login 500 91.715 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: test@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: Cannot read properties of undefined (reading 'rows') TypeError: Cannot read properties of undefined (reading 'rows')
        at rows (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:267:62)
        at processTicksAndRejections (node:internal/process/task_queues:103:5)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)

POST /api/auth/login 500 42.325 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: test@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: Cannot read properties of undefined (reading 'rows') TypeError: Cannot read properties of undefined (reading 'rows')
        at rows (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:267:62)
        at processTicksAndRejections (node:internal/process/task_queues:103:5)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)

POST /api/auth/login 500 51.280 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]"}
POST /api/auth/register 400 3.422 ms - anonymous - {"email":"invalid-email","password":"[REDACTED]","name":"Test User"}
POST /api/auth/register 400 2.919 ms - anonymous - {"email":"test@example.com","password":"[REDACTED]","name":"Test User"}
POST /api/auth/login 400 1.612 ms - anonymous - {"email":{"$ne":null},"password":"[REDACTED]"}
POST /api/chamas 401 1.911 ms - anonymous - {"name":"Test <script>alert(1)</script>","description":"Description <script>alert(1)</script>"}
PASS tests/security.test.js
  Security Middleware
    Rate Limiting
      Î“ÃªÃœ should allow requests under the rate limit (658 ms)
      Î“ÃªÃœ should block requests over the rate limit (1 ms)
    Security Headers
      Î“ÃªÃœ should include security headers (26 ms)
    Input Validation
      Î“ÃªÃœ should reject invalid email format (40 ms)
      Î“ÃªÃœ should reject weak passwords (17 ms)
    NoSQL Injection Protection
      Î“ÃªÃœ should sanitize NoSQL injection attempts (21 ms)
    XSS Protection
      Î“ÃªÃœ should sanitize XSS attempts in request body (44 ms)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.error
    AUTH_REGISTER_ERROR: DB connection failed Error: DB connection failed
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:23:13)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:305:39
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:312:13)
        at Object.mockConstructor [as query] (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:102:19)
        at query (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:120:35)
        at Object.register (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:37:11)
        at Promise.finally.completed (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:275:16)
        at runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 225 |[39m     })[33m;[39m
     [90m 226 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 227 |[39m     console[33m.[39merror([32m"AUTH_REGISTER_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 228 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 229 |[39m       context[33m:[39m [32m"auth_register"[39m[33m,[39m
     [90m 230 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:227:13)
      at Object.register (tests/authErrors.test.js:37:11)

  console.error
    AUTH_REGISTER_ERROR: DB connection failed Error: DB connection failed
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:48:13)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:305:39
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:312:13)
        at Object.mockConstructor [as query] (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:102:19)
        at query (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:120:35)
        at Object.register (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:62:11)
        at Promise.finally.completed (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:275:16)
        at runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 225 |[39m     })[33m;[39m
     [90m 226 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 227 |[39m     console[33m.[39merror([32m"AUTH_REGISTER_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 228 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 229 |[39m       context[33m:[39m [32m"auth_register"[39m[33m,[39m
     [90m 230 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:227:13)
      at Object.register (tests/authErrors.test.js:62:11)

  console.log
    Querying database for user: login@example.com

      at log (controllers/authController.js:263:13)

  console.error
    AUTH_LOGIN_ERROR: DB connection failed Error: DB connection failed
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:73:13)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:305:39
        at Object.<anonymous> (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:312:13)
        at Object.mockConstructor [as query] (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-mock\build\index.js:102:19)
        at query (C:\Users\lewis\Desktop\chamasmart\backend\controllers\authController.js:264:31)
        at Object.login (C:\Users\lewis\Desktop\chamasmart\backend\tests\authErrors.test.js:84:11)
        at Promise.finally.completed (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1497:10)
        at _callCircusTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1007:40)
        at _runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:947:3)
        at C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:857:11)
        at run (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\jestAdapterInit.js:1918:21)
        at jestAdapter (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-circus\build\runner.js:101:19)
        at runTestInternal (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:275:16)
        at runTest (C:\Users\lewis\Desktop\chamasmart\backend\node_modules\jest-runner\build\index.js:343:7)

    [0m [90m 318 |[39m     })[33m;[39m
     [90m 319 |[39m   } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 320 |[39m     console[33m.[39merror([32m"AUTH_LOGIN_ERROR:"[39m[33m,[39m error[33m.[39mmessage[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 321 |[39m     logger[33m.[39mlogError(error[33m,[39m {
     [90m 322 |[39m       context[33m:[39m [32m"auth_login"[39m[33m,[39m
     [90m 323 |[39m       email[33m:[39m req[33m.[39mbody[33m?[39m[33m.[39memail[33m,[39m[0m

      at error (controllers/authController.js:320:13)
      at Object.login (tests/authErrors.test.js:84:11)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“Â£Ã  audit secrets and track compliance: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/authErrors.test.js
  Auth controller error handling
    Î“ÃªÃœ hides internal error details in production for register (117 ms)
    Î“ÃªÃœ includes error details in non-production for register (18 ms)
    Î“ÃªÃœ hides internal error details in production for login (113 ms)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

GET /api/rosca/cycles/123/roster 403 8.516 ms - 999 - -
GET /api/rosca/cycles/123/roster 200 3.706 ms - 999 - -
PASS tests/roscaRoutes.int.test.js
  ROSCA routes integration - roster security
    Î“ÃªÃœ denies roster access for non-member (403) (87 ms)
    Î“ÃªÃœ authorized member can see roster without PII (no phone_number/trust_score) (65 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

POST /api/auth/register 201 510.443 ms - anonymous - {"email":"test1768842543198@example.com","password":"[REDACTED]","firstName":"Test","lastName":"User","phoneNumber":"0712345678"}
POST /api/auth/register 400 2.540 ms - anonymous - {"email":"test@example.com"}
POST /api/auth/register 400 1.315 ms - anonymous - {"email":"duplicate1768842543886@example.com","password":"[REDACTED]","firstName":"Test","lastName":"User","phoneNumber":"0712345678"}
  console.log
    Querying database for user: logintest1768842543930@example.com

      at log (controllers/authController.js:263:13)

  console.log
    Database query result: { rowCount: 1 }

      at log (controllers/authController.js:267:13)

POST /api/auth/login 200 22.465 ms - anonymous - {"email":"logintest1768842543930@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: logintest1768842543930@example.com

      at log (controllers/authController.js:263:13)

  console.log
    Database query result: { rowCount: 1 }

      at log (controllers/authController.js:267:13)

POST /api/auth/login 401 29.337 ms - anonymous - {"email":"logintest1768842543930@example.com","password":"[REDACTED]"}
  console.log
    Querying database for user: nonexistent@example.com

      at log (controllers/authController.js:263:13)

  console.log
    Database query result: { rowCount: 0 }

      at log (controllers/authController.js:267:13)

POST /api/auth/login 401 20.708 ms - anonymous - {"email":"nonexistent@example.com","password":"[REDACTED]"}
PASS tests/auth.test.js
  Authentication API
    POST /api/auth/register
      Î“ÃªÃœ should register a new user (645 ms)
      Î“ÃªÃœ should reject registration with missing fields (42 ms)
      Î“ÃªÃœ should reject duplicate email (44 ms)
    POST /api/auth/login
      Î“ÃªÃœ should login with correct credentials (64 ms)
      Î“ÃªÃœ should reject login with wrong password (146 ms)
      Î“ÃªÃœ should reject login with non-existent email (223 ms)
  Health Check API
    Î“ÃªÃœ should return health status (224 ms)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/ascaController.test.js
  ASCA Controller - buyShares
    Î“ÃªÃœ rejects invalid payment method (4 ms)
    Î“ÃªÃœ creates share purchase with valid payment method and computes shares (15 ms)
  ASCA Controller - getMyEquity
    Î“ÃªÃœ computes equity based on total assets and shares (7 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  enable debug logging with { debug: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

PASS tests/metrics.test.js
  /metrics protection
    Î“ÃªÃœ rejects unauthorized metrics access when token is set in production (128 ms)
    Î“ÃªÃœ allows metrics access with correct token in production (95 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: â‰¡Æ’Ã´Ã­ add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    STABILIZED: Server running on port 5005

      at Server.log (server.js:235:11)

GET /socket.io/?EIO=4&transport=websocket 200 245.840 ms - anonymous - -
PASS tests/socketAuth.test.js
  Socket.io authentication
    Î“ÃªÃœ rejects connection without token (411 ms)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/authVerification.test.js
  Auth verification endpoints
    verifyEmail
      Î“ÃªÃœ rejects missing token (3 ms)
      Î“ÃªÃœ verifies email with valid token (10 ms)
    verifyPhone
      Î“ÃªÃœ rejects missing code (2 ms)
      Î“ÃªÃœ verifies phone with correct OTP and not expired (2 ms)
    resendEmailVerification
      Î“ÃªÃœ returns 404 when user not found (1 ms)
      Î“ÃªÃœ enforces cooldown when last sent recently (5 ms)
      Î“ÃªÃœ resends when outside cooldown window (2 ms)
    resendPhoneVerification
      Î“ÃªÃœ returns 404 when user not found (3 ms)
      Î“ÃªÃœ enforces cooldown when last SMS sent recently (2 ms)
      Î“ÃªÃœ resends OTP when outside cooldown window (3 ms)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

  console.log
    [TEST] Query: BEGIN

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [TEST] Query: SELECT 1 FROM chama_members 
                 WHERE ch

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [TEST] Query: INSERT INTO rosca_cycles 
                 (chama_id,

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [TEST] Query: SELECT user_id FROM chama_members 
                 WH

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [TEST] Query: INSERT INTO rosca_roster (cycle_id, user_id, posit

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [TEST] Query: COMMIT

      at Object.log (tests/rosca_controller_fixed.test.js:44:15)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: â‰¡Æ’Ã¶Ã¦ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS tests/rosca_controller_fixed.test.js
  ROSCA createCycle - parameterized roster insert
    Î“ÃªÃœ uses parameterized VALUES and correct payout amounts (41 ms)

  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [MOCK] Loading mocked database

      at Object.log (config/__mocks__/db.js:2:9)

PASS tests/requestLogger.test.js
  Request Logger Middleware
    sanitizeBody
      Î“ÃªÃœ should redact password field (11 ms)
      Î“ÃªÃœ should redact multiple sensitive fields (2 ms)
      Î“ÃªÃœ should handle null/undefined body (1 ms)
    sanitizeHeaders
      Î“ÃªÃœ should partially redact authorization header (2 ms)
      Î“ÃªÃœ should redact cookie header (4 ms)

FAIL tests/roscaController.test.js
  Î“Ã¹Ã… Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     Î“Ã‡Ã³ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     Î“Ã‡Ã³ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     Î“Ã‡Ã³ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     Î“Ã‡Ã³ If you need a custom transformation, specify a "transform" option in your config.
     Î“Ã‡Ã³ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    SyntaxError: C:\Users\lewis\Desktop\chamasmart\backend\tests\roscaController.test.js: Unexpected reserved word 'await'. (301:24)

      299 |     });
      300 |
    > 301 |     const _dbgClient3 = await db.connect();
          |                         ^
      302 |     // eslint-disable-next-line no-console
      303 |     console.log('DEBUG rosca payout happy-path client:', !!_dbgClient3, Object.keys(_dbgClient3 || {}));
      304 |     if (_dbgClient3 && _dbgClient3.release) _dbgClient3.release();

      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)
      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1507:19)
      at Parser.raise [as checkReservedWord] (node_modules/@babel/parser/src/parser/expression.ts:2896:12)
      at Parser.checkReservedWord [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2858:12)
      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2815:23)
      at Parser.parseIdentifier [as parseExprAtom] (node_modules/@babel/parser/src/parser/expression.ts:1304:27)
      at Parser.parseExprAtom [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:742:23)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at parseMaybeAssign (node_modules/@babel/parser/src/parser/expression.ts:257:12)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3197:16)
      at Parser.allowInAnd [as parseMaybeAssignAllowIn] (node_modules/@babel/parser/src/parser/expression.ts:256:17)
      at Parser.parseMaybeAssignAllowIn [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1587:18)
      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1251:10)
      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:612:21)
      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:482:17)
      at Parser.parseStatementLike [as parseStatementListItem] (node_modules/@babel/parser/src/parser/statement.ts:431:17)
      at Parser.parseStatementListItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1444:16)
      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1417:10)
      at Parser.parseBlockBody [as parseBlock] (node_modules/@babel/parser/src/parser/statement.ts:1385:10)
      at Parser.parseBlock [as parseFunctionBody] (node_modules/@babel/parser/src/parser/expression.ts:2626:24)
      at Parser.parseFunctionBody [as parseArrowExpression] (node_modules/@babel/parser/src/parser/expression.ts:2563:10)
      at Parser.parseArrowExpression [as parseParenAndDistinguishExpression] (node_modules/@babel/parser/src/parser/expression.ts:1847:12)
      at Parser.parseParenAndDistinguishExpression [as parseExprAtom] (node_modules/@babel/parser/src/parser/expression.ts:1170:21)
      at Parser.parseExprAtom [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:742:23)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at parseMaybeAssign (node_modules/@babel/parser/src/parser/expression.ts:257:12)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3202:12)
      at Parser.allowInAnd [as parseMaybeAssignAllowIn] (node_modules/@babel/parser/src/parser/expression.ts:256:17)
      at Parser.parseMaybeAssignAllowIn [as parseMaybeAssignAllowInOrVoidPattern] (node_modules/@babel/parser/src/parser/expression.ts:3316:17)
      at Parser.parseMaybeAssignAllowInOrVoidPattern [as parseExprListItem] (node_modules/@babel/parser/src/parser/expression.ts:2798:18)
      at Parser.parseExprListItem [as parseCallExpressionArguments] (node_modules/@babel/parser/src/parser/expression.ts:1042:14)
      at Parser.parseCallExpressionArguments [as parseCoverCallAndAsyncArrowHead] (node_modules/@babel/parser/src/parser/expression.ts:922:29)
      at Parser.parseCoverCallAndAsyncArrowHead [as parseSubscript] (node_modules/@babel/parser/src/parser/expression.ts:804:19)
      at Parser.parseSubscript [as parseSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:763:19)
      at Parser.parseSubscripts [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:748:17)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at Parser.parseMaybeAssign [as parseExpressionBase] (node_modules/@babel/parser/src/parser/expression.ts:226:23)
      at parseExpressionBase (node_modules/@babel/parser/src/parser/expression.ts:217:39)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3197:16)
      at Parser.allowInAnd [as parseExpression] (node_modules/@babel/parser/src/parser/expression.ts:217:17)
      at Parser.parseExpression [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:688:23)
      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:482:17)
      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:419:17)
      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1443:16)
      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1417:10)
      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:229:10)
      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)
      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:88:25)
      at parse (node_modules/@babel/parser/src/index.ts:86:38)
      at parser (node_modules/@babel/core/src/parser/index.ts:29:19)
          at parser.next (<anonymous>)
      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:50:24)
          at normalizeFile.next (<anonymous>)
      at run (node_modules/@babel/core/src/transformation/index.ts:41:36)
          at run.next (<anonymous>)
      at transform (node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync (node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)
      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/index.js:422:31)
      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/index.js:519:40)
      at ScriptTransformer.transform (node_modules/@jest/transform/build/index.js:558:19)

FAIL tests/ascaRoutes.int.test.js
  Î“Ã¹Ã… Test suite failed to run

    Jest encountered an unexpected token

    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.

    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.

    By default "node_modules" folder is ignored by transformers.

    Here's what you can do:
     Î“Ã‡Ã³ If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.
     Î“Ã‡Ã³ If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript
     Î“Ã‡Ã³ To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     Î“Ã‡Ã³ If you need a custom transformation, specify a "transform" option in your config.
     Î“Ã‡Ã³ If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/configuration
    For information about custom transformations, see:
    https://jestjs.io/docs/code-transformation

    Details:

    SyntaxError: C:\Users\lewis\Desktop\chamasmart\backend\tests\ascaRoutes.int.test.js: Unexpected reserved word 'await'. (134:16)

      132 |     db.__mockClientQuery.mockImplementation(impl);
      133 |
    > 134 |     const res = await request(app)
          |                 ^
      135 |       .post('/api/asca/1/buy-shares')
      136 |       .set('Authorization', 'Bearer fake-token')
      137 |       .send({ amount: 1000, paymentMethod: 'mpesa' })

      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)
      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1507:19)
      at Parser.raise [as checkReservedWord] (node_modules/@babel/parser/src/parser/expression.ts:2896:12)
      at Parser.checkReservedWord [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2858:12)
      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2815:23)
      at Parser.parseIdentifier [as parseExprAtom] (node_modules/@babel/parser/src/parser/expression.ts:1304:27)
      at Parser.parseExprAtom [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:742:23)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at parseMaybeAssign (node_modules/@babel/parser/src/parser/expression.ts:257:12)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3197:16)
      at Parser.allowInAnd [as parseMaybeAssignAllowIn] (node_modules/@babel/parser/src/parser/expression.ts:256:17)
      at Parser.parseMaybeAssignAllowIn [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1587:18)
      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1251:10)
      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:612:21)
      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:482:17)
      at Parser.parseStatementLike [as parseStatementListItem] (node_modules/@babel/parser/src/parser/statement.ts:431:17)
      at Parser.parseStatementListItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1444:16)
      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1417:10)
      at Parser.parseBlockBody [as parseBlock] (node_modules/@babel/parser/src/parser/statement.ts:1385:10)
      at Parser.parseBlock [as parseFunctionBody] (node_modules/@babel/parser/src/parser/expression.ts:2626:24)
      at Parser.parseFunctionBody [as parseArrowExpression] (node_modules/@babel/parser/src/parser/expression.ts:2563:10)
      at Parser.parseArrowExpression [as parseParenAndDistinguishExpression] (node_modules/@babel/parser/src/parser/expression.ts:1847:12)
      at Parser.parseParenAndDistinguishExpression [as parseExprAtom] (node_modules/@babel/parser/src/parser/expression.ts:1170:21)
      at Parser.parseExprAtom [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:742:23)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at parseMaybeAssign (node_modules/@babel/parser/src/parser/expression.ts:257:12)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3202:12)
      at Parser.allowInAnd [as parseMaybeAssignAllowIn] (node_modules/@babel/parser/src/parser/expression.ts:256:17)
      at Parser.parseMaybeAssignAllowIn [as parseMaybeAssignAllowInOrVoidPattern] (node_modules/@babel/parser/src/parser/expression.ts:3316:17)
      at Parser.parseMaybeAssignAllowInOrVoidPattern [as parseExprListItem] (node_modules/@babel/parser/src/parser/expression.ts:2798:18)
      at Parser.parseExprListItem [as parseCallExpressionArguments] (node_modules/@babel/parser/src/parser/expression.ts:1042:14)
      at Parser.parseCallExpressionArguments [as parseCoverCallAndAsyncArrowHead] (node_modules/@babel/parser/src/parser/expression.ts:922:29)
      at Parser.parseCoverCallAndAsyncArrowHead [as parseSubscript] (node_modules/@babel/parser/src/parser/expression.ts:804:19)
      at Parser.parseSubscript [as parseSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:763:19)
      at Parser.parseSubscripts [as parseExprSubscripts] (node_modules/@babel/parser/src/parser/expression.ts:748:17)
      at Parser.parseExprSubscripts [as parseUpdate] (node_modules/@babel/parser/src/parser/expression.ts:721:21)
      at Parser.parseUpdate [as parseMaybeUnary] (node_modules/@babel/parser/src/parser/expression.ts:683:23)
      at Parser.parseMaybeUnary [as parseMaybeUnaryOrPrivate] (node_modules/@babel/parser/src/parser/expression.ts:417:14)
      at Parser.parseMaybeUnaryOrPrivate [as parseExprOps] (node_modules/@babel/parser/src/parser/expression.ts:429:23)
      at Parser.parseExprOps [as parseMaybeConditional] (node_modules/@babel/parser/src/parser/expression.ts:384:23)
      at Parser.parseMaybeConditional [as parseMaybeAssign] (node_modules/@babel/parser/src/parser/expression.ts:301:21)
      at Parser.parseMaybeAssign [as parseExpressionBase] (node_modules/@babel/parser/src/parser/expression.ts:226:23)
      at parseExpressionBase (node_modules/@babel/parser/src/parser/expression.ts:217:39)
      at Parser.callback [as allowInAnd] (node_modules/@babel/parser/src/parser/expression.ts:3197:16)
      at Parser.allowInAnd [as parseExpression] (node_modules/@babel/parser/src/parser/expression.ts:217:17)
      at Parser.parseExpression [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:688:23)
      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:482:17)
      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:419:17)
      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1443:16)
      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1417:10)
      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:229:10)
      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)
      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:88:25)
      at parse (node_modules/@babel/parser/src/index.ts:86:38)
      at parser (node_modules/@babel/core/src/parser/index.ts:29:19)
          at parser.next (<anonymous>)
      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:50:24)
          at normalizeFile.next (<anonymous>)
      at run (node_modules/@babel/core/src/transformation/index.ts:41:36)
          at run.next (<anonymous>)
      at transform (node_modules/@babel/core/src/transform.ts:29:20)
          at transform.next (<anonymous>)
      at evaluateSync (node_modules/gensync/index.js:251:28)
      at sync (node_modules/gensync/index.js:89:14)
      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)
      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)
      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/index.js:422:31)
      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/index.js:519:40)
      at ScriptTransformer.transform (node_modules/@jest/transform/build/index.js:558:19)

Test Suites: 2 failed, 11 passed, 13 total
Tests:       43 passed, 43 total
Snapshots:   0 total
Time:        49.299 s
Ran all test suites.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
